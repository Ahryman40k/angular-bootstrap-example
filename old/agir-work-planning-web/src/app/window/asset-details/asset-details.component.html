<div class="py-0 border-bottom shadow-sm" *ngIf="asset">
  <div class="d-flex justify-content-between align-items-center py-2">
    <div class="d-flex">
      <h3 class="px-4 pb-0">
        {{ asset?.id }}
      </h3>
    </div>
    <div class="d-flex col-xs-12 pr-3">
      <app-more-options-button *ngIf="showOptionsButton">
        <a ngbDropdownItem appWindowLink [href]="interventionService.createInterventionLink(asset)" *ngIf="Permission.INTERVENTION_WRITE | appPermission">Créer une intervention à partir de l'actif</a>
      </app-more-options-button>
      <button type="button" (click)="close()" class="btn btn-secondary btn-squared font-weight-bold px-2">
        Fermer
      </button>
    </div>
  </div>
</div>

<div class="d-flex flex-1" *ngIf="asset">
  <div class="flex-1 scrollable">
    <div class="details-overview p-4">
      <div class="mb-4 mr-4 flex-1">
        <h2>Vue d'ensemble de {{ asset?.id }}</h2>
        <p class="mt-1">{{ asset?.typeId | appTaxonomy: TaxonomyGroup.assetType }}</p>

        <div>
          <h4 class="my-2">Attributs principaux</h4>
          <div class="d-flex justify-content-between">
            <table class="table-label-value flex-1">
              <tbody>
                <tr>
                  <td class="col-5">Propriétaire</td>
                  <td>
                    {{ asset?.ownerId | appTaxonomy: TaxonomyGroup.assetOwner }}
                  </td>
                </tr>
                <tr>
                  <td class="col-5">Dernière intervention</td>
                  <td>
                    <a class="is-external-link link-xs" href="{{interventionService.getInterventionLink(lastIntervention)}}" appWindowLink *ngIf="lastIntervention">{{ lastIntervention.interventionYear }}</a>
                    <div *ngIf="!lastIntervention">{{ '' | vdmNa }}</div>
                  </td>
                </tr>
                <tr *ngFor="let property of mainProperties">
                  <td class="col-5">{{ property.code | appTaxonomy: TaxonomyGroup.assetDataKey }}</td>
                  <td>{{ property.value | vdmNa }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div *ngIf="properties?.length">

          <div class="border-bottom my-4"></div>

          <h4 class="my-2">Détails de l'actif</h4>
          <div class="d-flex justify-content-between">
            <table class="table-label-value flex-1">
              <tbody>
                <tr *ngFor="let property of properties">
                  <td class="col-5">{{ property.code | appTaxonomy: TaxonomyGroup.assetDataKey }}</td>
                  <td>{{ property.value | vdmNa }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="map border rounded" [class.invisible]="!mapShown">
        <app-map #map [withPanelMenu]="false" [withPanel]="false" [withRightPanel]="false"
          [withNonGeolocatedProjectsPanel]="false" [withPlanningBook]="false" [withInterventions]="false"
          [withProjects]="false" [initZoom]="25" [popupsEnabled]="false" class="d-inline-block w-100 h-100"></app-map>
      </div>
    </div>
  </div>
</div>
