<div class="d-flex mt-4">
  <h3>Carnets</h3>
  <app-details-add-button
    style="margin-left:auto"
    (onAdd)="createProgramBook()"
    *ngIf="(Permission.PROGRAM_BOOK_WRITE | appPermission) && canInteract && (restrictionItems | appRestrictions)"
  ></app-details-add-button>
</div>
<div class="pt-4 details" *ngIf="Permission.PROGRAM_BOOK_READ | appPermission">
  <div class="mt-2" *ngIf="programBookBlocks?.length">
    <div
      [ngClass]="{ 'border-top': i > 0 }"
      class=" list-item-link"
      *ngFor="let item of programBookBlocks; let i = index"
      [routerLink]="['/program-books/', item.programBook.id]"
      routerLinkActive="active"
    >
      <div class="p-2 pb-0">
        <div class="d-flex">
          <div class="flex-fill">
            <h5 class="text-primary">{{ item.programBook.name }}</h5>
          </div>
          <div class="d-flex flex-row-reverse">
            <span
              [ngClass]="{
                'badge-success': item.programBook.status === 'new',
                'badge-success-light': item.programBook.status === 'programming',
                'badge-medium-blue': item.programBook.status === 'submittedFinal',
                'badge-light-blue': item.programBook.status === 'submittedPreliminary'
              }"
              class="badge"
              >{{ item.programBook.status | appTaxonomy: 'programBookStatus' }}</span
            >
          </div>
        </div>
        <div class="d-flex statistic ">
          <span class="mr-1 mt-1">{{ item.projectCount }} projets</span>
          <span class="mr-1 mt-1">-</span>
          <span class="mr-1 mt-1">{{ item.interventionCount }} interventions</span>
          <span class="mr-1 mt-1">-</span>
          <span class="mr-1 mt-1">{{ item.validSubmissionCount }} soumissions valides</span>
        </div>
        <ng-container *ngIf="item.programBook?.objectives?.length > 0">
          <app-objective-preview
            [condition]="objective.pin"
            [objective]="objective"
            *ngFor="let objective of item.programBook.objectives"
          ></app-objective-preview>
        </ng-container>
      </div>
    </div>
  </div>
</div>
<app-no-result
  *ngIf="programBookBlocks.length === 0 && !isLoading"
  [message]="emptyListMessage"
  [showEmtyIcon]="true"
></app-no-result>
<div *ngIf="isLoading && programBookBlocks.length === 0" class="d-flex justify-content-center">
  <app-spinner></app-spinner>
</div>
