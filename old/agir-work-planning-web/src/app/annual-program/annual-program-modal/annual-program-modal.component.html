<app-layout-modal [modalTitle]="title" *ngIf="form">
  <div body>
    <form [formGroup]="form">
      <div class="row">
        <div class="form-group col-md-6">
          <label>Exécutant</label>
          <vdm-select
            appendTo="app-annual-program-modal"
            bindLabel="label.fr"
            bindValue="code"
            formControlName="executor"
            [items]="executors"
            autofocus="true"
          ></vdm-select>
          <app-form-errors formControlName="executor">
            <app-form-error *appFormError="let e; key: 'required'">L'exécutant est requis</app-form-error>
          </app-form-errors>
        </div>
        <div class="form-group col-md-6">
          <label>Année</label>
          <vdm-select
            appendTo="app-annual-program-modal"
            bindLabel="label.fr"
            formControlName="year"
            [items]="yearList"
          ></vdm-select>
          <app-form-errors formControlName="year">
            <app-form-error *appFormError="let e; key: 'required'">L'année de programmation est requise</app-form-error>
          </app-form-errors>
        </div>
      </div>
      <div class="row">
        <div class="form-group col-md-6">
          <label>Seuil budgétaire projet maximum (k$)</label>
          <input type="text" class="form-control" vdmIntegerInput formControlName="budgetCap" />
          <app-form-errors formControlName="budgetCap">
            <app-form-error *appFormError="let e; key: 'required'">Le seuil budgétaire est requis</app-form-error>
          </app-form-errors>
        </div>
      </div>
      <div class="form-group">
        <label>
          Description
          <span class="form-optional">Facultatif</span>
        </label>
        <textarea rows="3" class="form-control w-100" formControlName="notes"></textarea>
      </div>
    </form>
    <app-alert type="danger" *ngIf="isUpdating && !canUpdateExecutorAndYear">
      <span title>Attention!</span>
      <span description>
        Il est impossible de modifier l'exécutant et l'année de cette programmation annuelle, puisque un de ses carnets
        contient un ou des projets.
      </span>
    </app-alert>
  </div>
  <div buttons>
    <button type="button" class="btn btn-tertiary btn-squared bg-white mr-2" (click)="reject()">
      Annuler
    </button>
    <button type="submit" class="btn btn-primary btn-squared add-button" [disabled]="submitting" (click)="submit()">
      {{ buttonLabel }}
    </button>
  </div>
</app-layout-modal>
